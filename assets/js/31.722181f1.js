(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{374:function(t,e,s){"use strict";s.r(e);var a=s(34),n=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"hosting-panels-firewall-rulesets-specific-settings-modsec"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hosting-panels-firewall-rulesets-specific-settings-modsec","aria-hidden":"true"}},[t._v("#")]),t._v(" Hosting Panels Firewall Rulesets Specific Settings & ModSec")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#cpanel"}},[t._v("cPanel")]),s("ul",[s("li",[s("a",{attrs:{href:"#modsecurity-settings"}},[t._v("ModSecurity Settings")])]),s("li",[s("a",{attrs:{href:"#modsecurity-3-apache-limitations"}},[t._v("ModSecurity 3 + Apache limitations")])])])]),s("li",[s("a",{attrs:{href:"#plesk"}},[t._v("Plesk")]),s("ul",[s("li",[s("a",{attrs:{href:"#modsecurity-configuration"}},[t._v("ModSecurity Configuration")])])])]),s("li",[s("a",{attrs:{href:"#directadmin"}},[t._v("DirectAdmin")])])])]),s("p"),t._v(" "),s("p",[t._v("This section includes specific settings for each hosting panel that Imunify360 supports. It is important to follow these instructions to setup Imunify360 plugin properly.")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(", the important software for Imunify360, is not installed automatically during Imunify360 installation process. Without "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(", Imunify360 will lack the following features:")]),t._v(" "),s("ul",[s("li",[t._v("Web application firewall")]),t._v(" "),s("li",[t._v("Malware scanning of files uploaded using web")])])]),s("p",[s("span",{staticClass:"notranslate"},[t._v("Mod_security")]),t._v(" installation process is specific for different panels:")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Find the official cPanel documentation "),s("a",{attrs:{href:"https://documentation.cpanel.net/display/EA4/Apache+Module%3A+ModSecurity#ApacheModule:ModSecurity-InstallModSecHowtoinstalloruninstallmod_security2",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[t._v("Find the official Plesk documentation "),s("a",{attrs:{href:"https://docs.plesk.com/en-US/onyx/administrator-guide/server-administration/web-application-firewall-modsecurity.73383/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1)])])]),t._v(" "),s("div",{staticClass:"danger custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Important!")]),s("p",[t._v("If "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" is installed after Imunify360, it is important to execute the following command to add "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" ruleset to Imunify360:")]),t._v(" "),s("p",[t._v("For cPanel/Plesk/DirectAdmin/Stand-alone:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify360-agent install-vendors\n")])])])])]),s("p",[t._v("If "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" is installed before Imunify360, the rules will be installed automatically.")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("If Imunify360 installer detects any existing ruleset, it installs only minimal set of its rules. So, you need to disable all third-party rulesets prior to Imunify360 installation to get the full ruleset installed automatically.")])]),s("h2",{attrs:{id:"cpanel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cpanel","aria-hidden":"true"}},[t._v("#")]),t._v(" cPanel")]),t._v(" "),s("p",[t._v("It is possible to enable "),s("span",{staticClass:"notranslate"},[t._v("Service Status")]),t._v(" checker for Imunify360. To do so, perform the following steps:")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Go to "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Service Configuration")])]),t._v(" and choose "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Service Manager")])]),t._v(".")])]),t._v(" "),s("li",[s("p",[t._v("In "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Additional Services")])]),t._v(" section tick "),s("span",{staticClass:"notranslate"},[s("code",[t._v("imunify360")])]),t._v(" and "),s("span",{staticClass:"notranslate"},[s("code",[t._v("imunify360-webshield")])]),t._v(" checkboxes.")])]),t._v(" "),s("li",[s("p",[t._v("Click "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Save")])]),t._v(" and wait until cPanel enables the "),s("span",{staticClass:"notranslate"},[t._v("Service Status")]),t._v(" checker for Imunify360.")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/cpanel_set01.png",alt:""}})]),t._v(" "),s("p",[t._v("If succeeded, the status of Imunify360 service will be displayed at "),s("span",{staticClass:"notranslate"},[t._v("Service Status")]),t._v(" section of "),s("span",{staticClass:"notranslate"},[t._v("Server Status")]),t._v(".")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/cpanel_set02.png",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"modsecurity-settings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#modsecurity-settings","aria-hidden":"true"}},[t._v("#")]),t._v(" ModSecurity Settings")]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("Since version 92, cPanel is adding experimental support of ModSecurity 3.x and starting from version 5.7, we implement "),s("strong",[t._v("experimental")]),t._v(" support of ModSecurity version 3 on cPanel. Since the support is experimental, there are some limitations. Please find them "),s("RouterLink",{attrs:{to:"/hosting_panels_specific_settin/#modsecurity-3-apache-limitations"}},[t._v("here")]),t._v(".")],1)]),s("p",[t._v("Recommended "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" settings are:")]),t._v(" "),s("ul",[s("li",[s("span",{staticClass:"notranslate"},[t._v("Audit Log Level – Only log noteworthy transactions")])]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[t._v("Connections Engine – Do not process the rules")])]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[t._v("Rules Engine – Process the rules")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/modsecuritysettings.png",alt:""}})]),t._v(" "),s("p",[t._v("It’s also recommended to disable any third-party "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" vendors except Imunify360 ruleset (especially "),s("strong",[t._v("OWASP")]),t._v(" and "),s("strong",[t._v("Comodo")]),t._v(" ). These rulesets can cause large number of false-positives and duplicate Imunify360 ruleset.")]),t._v(" "),s("p",[t._v("To do so, go to "),s("span",{staticClass:"notranslate"},[t._v("ModSecurity Vendors")]),t._v(" section of cPanel main menu, and switch to "),s("span",{staticClass:"notranslate"},[s("code",[t._v("Off")])]),t._v(" all enabled vendors except Imunify360 ruleset.\nIf there is no Imunify360 ruleset installed, run "),s("span",{staticClass:"notranslate"},[s("code",[t._v("imunify360-agent install-vendors")])]),t._v(" command.")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/ModSecVendors.png",alt:""}})]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Enable rules auto-update. Otherwise, you won't get important updates of ModSecurity ruleset in time")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("For Apache run the following command:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("/usr/local/cpanel/scripts/modsec_vendor enable-updates imunify360-full-apache\n")])])])])]),t._v(" "),s("li",[s("p",[t._v("For LiteSpeed run the following command:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("/usr/local/cpanel/scripts/modsec_vendor enable-updates imunify360-full-litespeed \n")])])])])])]),t._v(" "),s("p",[t._v("See details "),s("a",{attrs:{href:"https://documentation.cpanel.net/display/82Docs/ModSecurity+Vendors#ModSecurityVendors-Enableordisableupdates",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[t._v("Or you can use "),s("a",{attrs:{href:"https://documentation.cpanel.net/display/DD/WHM+API+1+Functions+-+modsec_enable_vendor_updates",target:"_blank",rel:"noopener noreferrer"}},[t._v("WHMAPI1"),s("OutboundLink")],1),t._v(" to enable vendor auto-updates.")])]),t._v(" "),s("li",[s("p",[t._v("It is possible to block ModSecurity rules only for IPs that belong to some country. More info can be found in "),s("RouterLink",{attrs:{to:"/faq_and_known_issues/#_9-disabling-waf-rules-for-certain-countries"}},[t._v("FAQ")])],1)])]),t._v(" "),s("h3",{attrs:{id:"modsecurity-3-apache-limitations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#modsecurity-3-apache-limitations","aria-hidden":"true"}},[t._v("#")]),t._v(" ModSecurity 3 + Apache limitations")]),t._v(" "),s("p",[t._v("Since version 92, cPanel is adding experimental support of ModSecurity 3.x and starting from version 5.7, we implement "),s("strong",[t._v("experimental")]),t._v(" support of ModSecurity version 3 on cPanel. There are still some issues that prevent some Imunify360 features from working property. The feature limitations are:")]),t._v(" "),s("ul",[s("li",[t._v("working with mod_ruid2")]),t._v(" "),s("li",[t._v("working with mod_remoteip")]),t._v(" "),s("li",[t._v("app-specific ruleset feature")]),t._v(" "),s("li",[t._v("HackerTrap")]),t._v(" "),s("li",[t._v("uploaded files scanning")]),t._v(" "),s("li",[t._v("simple password redirect")])]),t._v(" "),s("h2",{attrs:{id:"plesk"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#plesk","aria-hidden":"true"}},[t._v("#")]),t._v(" Plesk")]),t._v(" "),s("p",[t._v("It is not recommended to use firewalld and Plesk Firewall simultaneously, because Plesk does not fully support such configuration. We recommend to disable firewalld by running the command on the server:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("systemctl disable firewalld\n")])])])]),t._v(" "),s("p",[t._v("Read more about the problem at Plesk Help Center in this "),s("a",{attrs:{href:"https://support.plesk.com/hc/en-us/articles/115000905285-Plesk-Firewall-and-firewalld",target:"_blank",rel:"noopener noreferrer"}},[t._v("thread"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"modsecurity-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#modsecurity-configuration","aria-hidden":"true"}},[t._v("#")]),t._v(" ModSecurity Configuration")]),t._v(" "),s("ul",[s("li",[s("span",{staticClass:"notranslate"},[t._v("Web application firewall mode – On")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/modsecurityconfigurationpleskonyx.png",alt:""}})]),t._v(" "),s("p",[t._v("If any "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" ruleset was installed during Imunify360 installation, Imunify360 will not install its own ruleset, because Plesk supports only one ruleset at once.")]),t._v(" "),s("p",[t._v("To check, if Imunify360 ruleset is installed, run the following as root:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# plesk sbin modsecurity_ctl -L --enabled")]),t._v("\ncustom\n")])])])]),t._v(" "),s("p",[t._v("If the output does not contain imunify360, for example:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# plesk sbin modsecurity_ctl -L --enabled")]),t._v("\ntortix\n")])])])]),t._v(" "),s("p",[t._v("Then remove existing ruleset and install Imunify360 one:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# plesk sbin modsecurity_ctl --disable-all-rules --ruleset tortix")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# plesk sbin modsecurity_ctl --uninstall --ruleset tortix")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# plesk sbin modsecurity_ctl -L --enabled")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# imunify360-agent install-vendors")]),t._v("\nINFO    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("+ 3785ms"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                         defence360agent.simple_rpc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("Executing "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'install-vendors'")]),t._v(","),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", params: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nINFO    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("+ 8781ms"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("   defence360agent.subsys.panels.plesk.mod_security"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("Successfully installed vendor "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'imunify360-full-apache'")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(".")]),t._v("\nINFO    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("+ 8782ms"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                  defence360agent.subsys.web_server"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("Performing web_server graceful restart\nOK\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# plesk sbin modsecurity_ctl -L --enabled")]),t._v("\ncustom\n")])])])]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("Please make sure that "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Update rule sets")])]),t._v(" option is disabled in your Plesk "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Web Application Firewall")])]),t._v(" interface on the "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Settings")])]),t._v(" tab.")])]),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("Note that in the current version of Plesk, "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Update rule sets")])]),t._v(" option is available if one of the "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Atomic Basic ModSecurity/Advanced ModSecurity Rules by Atomicorp/Comodo ModSecurity")])]),t._v(" Rule Set is enabled.")])]),s("h2",{attrs:{id:"directadmin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#directadmin","aria-hidden":"true"}},[t._v("#")]),t._v(" DirectAdmin")]),t._v(" "),s("p",[t._v("During installation on DirectAdmin, Imunify360 will try to install "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" automatically using custombuild 2.0.")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("Automatic installation of Imunify360 ruleset is only supported with custombuild 2.0.")])])])},[],!1,null,null,null);e.default=n.exports}}]);